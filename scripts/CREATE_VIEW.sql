CREATE OR REPLACE VIEW BI_VIEW AS
SELECT 
a.DETAILS AS DIAGNOSIS,
b.AGE AS AGE,
b.ADMISSIONDATE as ADMITTED,
b.GENDER AS SEX,
b.ID AS PATIENT_ID,
b.DISCHARGETYPE DISPOSITION,
c."hospitalname" AS HOSPITAL,
d."reg_name" AS REGION_NAME
FROM
    DRG_DB.DRG_SCHEMA.ICD10CM a
JOIN
    DRG_DB.DRG_SCHEMA.DRG_ADMISSION b ON b.PDX = a.code,
JOIN 
    DRG_DB.DRG_SCHEMA.FACILITY c ON c."accreno"= b.ACCRENO
JOIN 
    DRG_DB.DRG_SCHEMA.REGION d ON c."regioncode" = d."regioncode";
-- WHERE
--     -- optional filtering conditions
--     condition;
 SELECT COUNT(ID) FROM DRG_DB.DRG_SCHEMA.DRG_ADMISSION;

CREATE INDEX index_icd10cm ON DRG_DB.DRG_SCHEMA.ICD10CM ("CODE");